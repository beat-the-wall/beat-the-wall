(function(){var n,t,e,o,i,u=Array.prototype.indexOf||function(n){for(var t=0,e=this.length;t<e;t++)if(t in this&&this[t]===n)return t;return-1};for(i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){return window.setTimeout(function(){return n(1e3/60)},1e3/60)},window.atom=t={},t.input={_bindings:{},_down:{},_pressed:{},_released:[],mouse:{x:0,y:0},bind:function(n,t){return this._bindings[n]=t},onkeydown:function(n){var t;if(t=this._bindings[o(n)])return this._down[t]||(this._pressed[t]=!0),this._down[t]=!0,n.stopPropagation(),n.preventDefault()},onkeyup:function(n){var t;if(t=this._bindings[o(n)])return this._released.push(t),n.stopPropagation(),n.preventDefault()},clearPressed:function(){var n,t,e,o;for(t=0,e=(o=this._released).length;t<e;t++)n=o[t],this._down[n]=!1;return this._released=[],this._pressed={}},pressed:function(n){return this._pressed[n]},down:function(n){return this._down[n]},released:function(n){return u.call(this._released,n)>=0},onmousemove:function(n){var t,e,o;return void 0!==window.pageXOffset?(this.mouse.x=n.clientX+window.pageXOffset,this.mouse.y=n.clientY+window.pageYOffset):(o=window.event,e=document.documentElement,t=document.body,this.mouse.x=o.clientX+e.scrollLeft+t.scrollLeft,this.mouse.y=o.clientY+e.scrollTop+t.scrollTop)},onmousedown:function(n){return this.onkeydown(n)},onmouseup:function(n){return this.onkeyup(n)},onmousewheel:function(n){return this.onkeydown(n),this.onkeyup(n)},oncontextmenu:function(n){if(this._bindings[t.button.RIGHT])return n.stopPropagation(),n.preventDefault()}},document.onkeydown=t.input.onkeydown.bind(t.input),document.onkeyup=t.input.onkeyup.bind(t.input),document.onmouseup=t.input.onmouseup.bind(t.input),t.button={LEFT:-1,MIDDLE:-2,RIGHT:-3,WHEELDOWN:-4,WHEELUP:-5},t.key={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40},e=65;e<=90;e++)t.key[String.fromCharCode(e)]=e;o=function(n){if("keydown"===n.type||"keyup"===n.type)return n.keyCode;if("mousedown"===n.type||"mouseup"===n.type)switch(n.button){case 0:return t.button.LEFT;case 1:return t.button.MIDDLE;case 2:return t.button.RIGHT}else if("mousewheel"===n.type)return n.wheel>0?t.button.WHEELUP:t.button.WHEELDOWN},t.canvas=document.getElementsByTagName("canvas")[0],t.canvas.style.position="absolute",t.canvas.style.top="0",t.canvas.style.left="0",t.context=t.canvas.getContext("2d"),t.canvas.onmousemove=t.input.onmousemove.bind(t.input),t.canvas.onmousedown=t.input.onmousedown.bind(t.input),t.canvas.onmouseup=t.input.onmouseup.bind(t.input),t.canvas.onmousewheel=t.input.onmousewheel.bind(t.input),t.canvas.oncontextmenu=t.input.oncontextmenu.bind(t.input),window.onresize=function(n){return t.canvas.width=window.innerWidth,t.canvas.height=window.innerHeight,t.width=t.canvas.width,t.height=t.canvas.height},window.onresize(),n=function(){function n(){}return n.prototype.update=function(n){},n.prototype.draw=function(){},n.prototype.run=function(){var n,t=this;if(!this.running)return this.running=!0,n=function(){if(t.running)return t.step(),i(n)},this.last_step=Date.now(),i(n)},n.prototype.stop=function(){return this.running=!1},n.prototype.step=function(){var n,e;return n=((e=Date.now())-this.last_step)/1e3,this.last_step=e,this.update(n),this.draw(),t.input.clearPressed()},n}(),t.Game=n}).call(this);