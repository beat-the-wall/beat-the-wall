function HUD(e,t){this.game=e,this.pre=t||!1,this.score=0,this.multiplier=4,this.gameOver=!1,this.physics=function(e){var t=this.game.objects.player,i=t.lines,s=t.branchStates[t.branchState],a=0;this.multiplier=4;for(var l=0;l<i.length;l++)i[l].isDead&&(a+=1);this.multiplier-=a,0===this.multiplier&&(this.gameOver=!0),this.multiplier*=s,this.score+=Math.ceil(1*this.multiplier*e/100)},this.draw=function(e){if(e.fillStyle="#222",e.font="20px sans-serif",e.fillText("Score: "+this.score,10,24),e.fillText("Multiplier: "+this.multiplier,10,48),this.game.objects.spawner&&e.fillText("Level: "+this.game.objects.spawner.level,this.game.canvas.width-100,24),this.pre){var t={w:400,h:400};e.fillRect(canvas.width/2-t.w/2,canvas.height/2-t.h/2,t.w,t.h),e.fillStyle="#FFF";var i=30;e.font=i+"px bold sans-serif";var s=Math.floor(canvas.width/2-150),a=Math.floor(canvas.height/2-i/2)-100;e.fillText("Avabranch",s,a);var l=localStorage.bestScore||this.score;e.fillText("Best: "+l,s,a+60),e.fillText("[Enter] to start game",s,a+120),e.fillText("[Space] to branch",s,a+180),e.fillText("[p] to pause",s,a+240)}else if(this.gameOver){this.game.play=!1;t={w:400,h:400};e.fillRect(canvas.width/2-t.w/2,canvas.height/2-t.h/2,t.w,t.h),e.fillStyle="#FFF";i=30;e.font=i+"px bold sans-serif";s=Math.floor(canvas.width/2-150),a=Math.floor(canvas.height/2-i/2)-50;e.fillText("Game Over",s,a);l=localStorage.bestScore||0;this.score>l&&(localStorage.bestScore=this.score,l=this.score),e.fillText("Score: "+this.score,s,a+60),e.fillText("Best: "+l,s,a+120),e.fillText("[Enter] for new game",s,a+180)}else if(this.game.paused){t={w:400,h:400};e.fillRect(canvas.width/2-t.w/2,canvas.height/2-t.h/2,t.w,t.h),e.fillStyle="#FFF";i=30;e.font=i+"px bold sans-serif";s=Math.floor(canvas.width/2-150),a=Math.floor(canvas.height/2-i/2)-50;e.fillText("Paused",s,a),e.fillText("[p] to resume",s,a+80)}else if(this.game.objects.player){var h=this.game.objects.player,o=10,r=this.game.canvas.height-50;e.fillText("controls ",o,r),r+=10;for(var n={},c=0;c<h.lines.length;c++){var f=h.lines[c];if(!f.isDead)n[p=f.keys[0]]?n[p].colors.push(f.color):n[p]={controls:f.keys,colors:[f.color]}}var g=Object.keys(n);for(c=0;c<g.length;c++){var p=g[c];this.drawKey(e,n[p].controls[0],n[p].colors,o,r),o+=30,this.drawKey(e,n[p].controls[1],n[p].colors,o,r),o+=30}}},this.drawKey=function(e,t,i,s,a){var l=e.font;e.font="20px monospace";for(var h=e.fillStyle,o=0;o<i.length;o++)e.fillStyle=i[o],this.coolBlock(e,s+26*o/i.length,a,26/i.length,36);e.fillStyle=h,e.fillText(t,s+7+(";"===t?2:0),a+23),e.font=l},this.coolBlock=function(e,t,i,s,a){e.beginPath(),e.moveTo(t+5,i),e.lineTo(t+s-5,i),e.quadraticCurveTo(t+s,i,t+s,i+5),e.lineTo(t+s,i+a-5),e.quadraticCurveTo(t+s,i+a,t+s-5,i+a),e.lineTo(t+5,i+a),e.quadraticCurveTo(t,i+a,t,i+a-5),e.lineTo(t,i+5),e.quadraticCurveTo(t,i,t+5,i),e.closePath(),e.fill()},keyListeners.push(["enter",function(){startGame()}.bind(this)]),this.suspend=function(){document.webkitHidden&&!this.game.paused&&this.game.play&&(this.game.paused=!0,this.game.play=!1,this.game.draw())},this.pre||(keyListeners.push(["p",function(){!this.game.paused&&this.game.play?(this.game.paused=!0,this.game.play=!1,this.game.draw()):this.game.paused&&!this.game.play&&(this.game.paused=!1,this.game.play=!0,this.game.update())}.bind(this)]),document.addEventListener("webkitvisibilitychange",this.suspend.bind(this),!1))}