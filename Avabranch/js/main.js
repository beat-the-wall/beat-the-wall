var canvas=document.getElementById("canv"),selecting=!1,keyListeners=[],keyState={},keyMap={13:"enter",37:"left",38:"up",39:"right",40:"down",186:";"};function init(){localStorage.soundSettings&&"off"==localStorage.soundSettings&&turnOffSound(),keyListeners=[],canvas.width=800,canvas.height=600,game=new Game(canvas),global_controls=new Controls;var e=new HUD(game,!0);game.addObject("hud",e),e.draw(game.ctx)}function startGame(){keyListeners=[],game.play=!1,game=new Game(canvas),player=new Player(game,null,null,null,game.speed),spawner=new BlockSpawner(game,game.speed),hud=new HUD(game),power_spawner=new PowerupSpawner(game),game.addObject("spawner",spawner),game.addObject("player",player),game.addObject("power_spawn",power_spawner),game.addObject("hud",hud),game.update()}function toggleSound(){var e=document.getElementById("mute"),n=document.getElementById("bgaudio");-1!=e.className.indexOf("up")?(e.className=e.className.replace("up","off"),n.pause(),localStorage.soundSettings="off"):(e.className=e.className.replace("off","up"),n.play(),localStorage.soundSettings="on")}function turnOffSound(){-1!=document.getElementById("mute").className.indexOf("up")&&toggleSound()}function turnOnSound(){-1!=document.getElementById("mute").className.indexOf("off")&&toggleSound()}window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,n){window.setTimeout(e,1e3/60)},window.onkeydown=function(e){try{keyState[keyMap[e.which]||String.fromCharCode(e.which)]=e.which}catch(e){console.log("error converting keypress to char code")}},window.onkeyup=function(e){try{delete keyState[keyMap[e.which]||String.fromCharCode(e.which)]}catch(e){console.log("error deleting keypress to char code")}},window.onkeypress=function(e){for(var n=0;n<keyListeners.length;n++){var a=keyMap[e.which]||String.fromCharCode(e.which);keyListeners[n][0]===a&&(e.preventDefault(),keyListeners[n][1]())}},init();